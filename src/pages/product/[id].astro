---
// Imports
import DefaultLayout from '../../layouts/DefaultLayout.astro';

const { id } = Astro.params;

const product = {
  id: Number(id),
  name: `Product Title ${id}`,
  price: 36.00,
  vendor: 'Artisan Crafts',
  description: `This is a premium handcrafted item. Made with care and designed to last.`,
  variations: [
    { type: 'Size', options: ['X-Small', 'Small', 'Medium', 'Large', 'X-Large', 'XX-Large', '3X-Large', '4X-Large'] },
    { type: 'Color', options: ['Black', 'Warm Sand'] },
  ],
  selected: {
    color: 'Warm Sand',
    size: 'Medium',
  },
  imageUrl: `https://images.unsplash.com/photo-1579783902671-98d626cffc79?q=80&w=600&auto=format&fit=crop`,
  images: [
    `https://images.unsplash.com/photo-1579783902671-98d626cffc79?q=80&w=600&auto=format&fit=crop`,
    `https://images.unsplash.com/photo-1588987025000-e0721126122b?q=80&w=600&auto=format&fit=crop`,
    `https://images.unsplash.com/photo-1578836522992-59151709729e?q=80&w=600&auto=format&fit=crop`,
  ],
};

const reviews = [
  { author: 'Jamie', rating: 5, content: "Absolutely loved the product! The quality is top-notch." },
  { author: 'Alex', rating: 4, content: "Arrived on time and beautifully packaged. Highly recommend." },
];
---

<DefaultLayout title={product.name} description={product.description}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10">

    <!-- Product Layout -->
    <div class="flex flex-col lg:flex-row gap-10 items-start">
      <!-- LEFT: Product Images -->
      <div class="flex flex-col lg:flex-row gap-4">
        <!-- Thumbnails -->
        <div class="flex lg:flex-col gap-2 overflow-x-auto lg:overflow-visible">
          {product.images.map((img, i) => (
            <img 
              src={img} 
              alt={`Thumbnail ${i + 1}`} 
              class="w-16 h-16 object-cover rounded-lg border-2 border-transparent hover:border-brand-magenta cursor-pointer thumbnail-image"
              data-src={img}
            />
          ))}
        </div>
        <!-- Main Image -->
        <div class="flex-1">
          <img id="main-product-image" src={product.imageUrl} alt={product.name} class="w-full max-w-md mx-auto lg:mx-0 rounded-lg shadow object-cover" />
        </div>
      </div>

      <!-- RIGHT: Product Details -->
      <div class="flex-1 space-y-6">
        <h1 class="text-3xl font-bold text-brand-text">{product.name}</h1>
        <p class="text-2xl font-semibold text-brand-orange">${product.price.toFixed(2)}</p>
        <p class="text-gray-600 text-sm">by <a href={`/vendor-portal?name=${product.vendor}`} class="text-brand-text font-medium hover:underline">{product.vendor}</a></p>
        <p class="text-sm text-gray-700">{product.description}</p>

        <!-- Variations: Color -->
        <div>
          <p class="text-sm font-semibold text-gray-700 mb-1">Color: {product.selected.color}</p>
          <div class="flex gap-2 flex-wrap">
            {product.variations.find(v => v.type === 'Color').options.map(color => (
              <div class={`p-2 border rounded-lg cursor-pointer text-sm ${color === product.selected.color ? 'border-brand-magenta' : 'border-gray-300'}`}>
                {color}
              </div>
            ))}
          </div>
        </div>

        <!-- Variations: Size -->
        <div>
          <p class="text-sm font-semibold text-gray-700 mb-1">Size: {product.selected.size}</p>
          <div class="flex flex-wrap gap-2">
            {product.variations.find(v => v.type === 'Size').options.map(size => (
              <div class={`px-3 py-1 border rounded-lg text-sm cursor-pointer ${size === product.selected.size ? 'border-brand-magenta' : 'border-gray-300'}`}>
                {size}
              </div>
            ))}
          </div>
        </div>

        <!-- Add to Cart -->
        <button class="w-full py-3 bg-brand-magenta text-white text-lg font-semibold rounded-lg hover:bg-brand-orange transition">
          Add to Cart
        </button>

        <!-- Details -->
        <div>
          <h3 class="text-lg font-bold">Product details</h3>
          <ul class="text-sm text-gray-700 list-disc pl-4">
            <li>Fabric type: Polycotton</li>
            <li>Care instructions: Machine Wash</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- REVIEWS SECTION -->
    <section class="mt-16 max-w-3xl mx-auto">
      <h2 class="text-2xl font-bold text-brand-text mb-6">Customer Reviews</h2>
      <div class="space-y-4">
        {reviews.map(review => (
          <div class="bg-white p-4 shadow rounded-lg">
            <p class="text-sm text-gray-800 mb-1">"{review.content}"</p>
            <p class="text-xs text-gray-500">– {review.author}, {"★".repeat(review.rating)}{"☆".repeat(5 - review.rating)}</p>
          </div>
        ))}
      </div>

      <!-- Leave a review form -->
      <div class="mt-8">
        <h3 class="text-lg font-semibold mb-2">Leave a Review</h3>
        <textarea rows="4" class="w-full p-3 border rounded-lg text-sm text-gray-700" placeholder="Share your experience..."></textarea>
        <button class="mt-2 px-4 py-2 bg-brand-magenta text-white rounded hover:bg-brand-orange transition">
          Submit
        </button>
      </div>
    </section>

  </div>
</DefaultLayout>

<script is:inline>
  const mainImage = document.getElementById('main-product-image');
  const thumbnails = document.querySelectorAll('.thumbnail-image');
  thumbnails.forEach(thumb => {
    thumb.addEventListener('click', () => {
      mainImage.src = thumb.dataset.src;
      thumbnails.forEach(t => t.classList.remove('border-brand-magenta'));
      thumb.classList.add('border-brand-magenta');
    });
  });
</script>
